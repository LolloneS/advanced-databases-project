# Advanced Databases 2CFU Project's Report
# Global Commodity Trade Statistics 
# Lorenzo Soligo - 806954

## Abstract
Comparison between the performances of a MongoDB database which uses some collections linked with references and a MongoDB database using a one-collection embedded-document structure, whilst working with a huge dataset (~1GB, 8+ million rows) representing trades statistics for many countries, with and without indexes.

## Dataset
[Global Commodity Trade Statistics](https://www.kaggle.com/unitednations/global-commodity-trade-statistics) by [United Nations](https://www.kaggle.com/unitednations)

### Fields
The dataset fields are:
* `country_or_area`:
  * name of the country or area the trade refers to
* `year`:
  * year in which the trade was done
* `comm_code`
  * code of the commodity traded
* `commodity`
  * name of the commodity traded
* `flow`
  * flow of the trade: Import, Export, ...
* `trade_usd`
  * amount of the trade, in US dollars
* `weight_kg`
  * weight of the commodity traded, in kilograms
* `quantity_name`
  * type of quantity (e.g. number of items, weight in kilograms, ...)
* `quantity`
  * number representing the quantity (e.g. number of items = 5)
* `category`
  * category of the trade




## Single collection, embedded structure

### Modeling the dataset

Modeling the dataset requires thinking about the best way to embed the fields in order to achieve clarity, ease of use and good performance.

After some reasoning, I think this is one of the best choices that could be made for the dataset. 
Every document represents a single trade.

* `ID` (generated by Mongo)
* `country_or_area`
* `year`
* `commodity`
  - `name`
  - `code`
  - `category`
* `trade_details`
  * `flow`
  * `weight_kg`
  * `trade_usd`
  * `quantity`
  * `quantity_name`



## Two collections with references

### Document structure (example)

Structuring the database using more than one collection lets us divide the *commodities* from the rest of the data regarding the trades, giving us the advantage of saving space - since many commodities are repeated thousands of times over the dataset's millions of rows

The rows will be thus splitted in two collections this way:

* `trades`
  * `ID` (generated by Mongo)
  * `country_or_area`
  * `year`
  * `commodity`
  * `trade_details`
    - `flow`
    - `weight_kg`
    - `trade_usd`
    - `quantity`
    - `quantity_name`
* `commodities`
  * `name`
  * `code`
  * `category`

## Time used to parse and import the dataset

| Single collection | Two collections |
| :---------------: | :-------------: |
|       TODO        |      TODO       |



## Execution time for the selected queries

I imported the dataset and ran the queries 5 times.

Indexes I created:

* on `country_or_area`
* on `commodity` and `comm_code`
* on `year`



#### Computer specs:
- Intel Core i5-6300U (low voltage laptop CPU)
- 8GB RAM DDR4
- 512GB NVMe SSD 




#### 1. Find for each year the country whose Export gain is highest
| Indexes \ DB        | Single collection | Two collections |
| ------------------- | :---------------: | :-------------: |
| **With Indexes**    |       TODO        |      TODO       |
| **Without Indexes** |       TODO        |      TODO       |


#### 2. For each year, find the country which traded more kilograms of *10511*
| Indexes \ DB        | Single collection | Two collections |
| ------------------- | :---------------: | :-------------: |
| **With Indexes**    |       TODO        |      TODO       |
| **Without Indexes** |       TODO        |      TODO       |


#### 3. Find the year in which more money was traded across all countries
| Indexes \ DB        | Single collection | Two collections |
| ------------------- | :---------------: | :-------------: |
| **With Indexes**    |       TODO        |      TODO       |
| **Without Indexes** |       TODO        |      TODO       |


#### 4. Find out whether Canada traded more sheeps or goats alive
| Indexes \ DB        | Single collection | Two collections |
| ------------------- | :---------------: | :-------------: |
| **With Indexes**    |       TODO        |      TODO       |
| **Without Indexes** |       TODO        |      TODO       |


#### 5. Find all the countries that have not traded 10600 or 10519 in 1998

#### 6. Find the most expensive trade for every year and for each country 

#### 7. Find out whether Italy traded more goats than Canada

#### 8. Find all the categories






